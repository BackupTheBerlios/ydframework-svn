<html>

<head>
    <title>Yellow Duck Framework 2.0 beta 4 - YDFileAndDirectory</title>
    <link rel="stylesheet" type="text/css" href="ydf2.css" />
</head>

<body>

    <div class="header">
        <a href="http://www.redcarpethost.com/index.php?c=9&s30" target="_blank"><img src="../../YDFramework2/images/sponsored_by_rch.gif"
         align="right" border="0" alt="Proudly sponsered by Red Carpet Host" width="170" height="69" /></a>
        <h2>Yellow Duck Framework 2.0</h2>
    </div>

    <div class="page">
<h3> Using files, images and directories </h3>
<br />
<a href="Documentation.html">Documentation table of contents</a><br />
<br />
In the Yellow Duck Framework, there are several classes that make it a lot easier to work with directories, files and images. By applying some very easy object oriented principles, we created some very powerful objects that will make using files faster and more efficient. All these classes are housed in the YDFileSystem module.<br />
<br />
<br />
<h4> Using files </h4>
<br />
For using files, a class called YDFSFile was created. This class takes the path to a file as it's argument, and returns you an object that has some shortcuts to frequently used properties and actions related to files.<br />
<br />
The following functions return property information from the file:<br />
<br />
<ul><li> <strong>getBasename</strong>: the basename of the file path, which is the filename including it's file extension
</li><li> <strong>getExtension</strong>: returns the file's extension
</li><li> <strong>getPath</strong>: gets the complete directory in which the file is stored
</li><li> <strong>getAbsolutePath</strong>: gets the absolute file path for our file
</li><li> <strong>getLastModified</strong>: gets the datetime on when the file was last modified
</li><li> <strong>getSize</strong>: gets the size of the file in bytes
</li><li> <strong>isImage</strong>: boolean indicating if the file is a image the system can recognize. Currently, only GIF, JPEG and PNG images are recognized
</li><li> <strong>isWriteable</strong>: boolean indicating if the file is read only or not (doesn't work reliably on Windows).</li></ul>
<br />
To get the contents of the file, you can use the <strong>getContents</strong> function. This function is able to read in both textual and binary data. Optionally, you can define at which byte it should start reading, and you can also define how many bytes should be read. If no options are specified, the complete file will be read.<br />
<br />
The following sample gives you an overview of some of the possibilities of the YDFSFile class:<br />
<br />
<div class="code"><code><font color="#000000">
<font color="#0000BB">&lt;?php<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;YDInclude</font><font color="#007700">( </font><font color="#DD0000">'YDFileSystem.php' </font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">YDInclude</font><font color="#007700">( </font><font color="#DD0000">'YDUtil.php' </font><font color="#007700">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">// Get the file object for the current file<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$file </font><font color="#007700">= new </font><font color="#0000BB">YDFSFile</font><font color="#007700">( </font><font color="#0000BB">__FILE__ </font><font color="#007700">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">// Dump the object<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#007700">echo( </font><font color="#DD0000">'&lt;br&gt;Basename: ' </font><font color="#007700">. </font><font color="#0000BB">$file</font><font color="#007700">-&gt;</font><font color="#0000BB">getBasename</font><font color="#007700">() );<br />&nbsp;&nbsp;&nbsp;&nbsp;echo( </font><font color="#DD0000">'&lt;br&gt;Extension: ' </font><font color="#007700">. </font><font color="#0000BB">$file</font><font color="#007700">-&gt;</font><font color="#0000BB">getExtension</font><font color="#007700">() );<br />&nbsp;&nbsp;&nbsp;&nbsp;echo( </font><font color="#DD0000">'&lt;br&gt;Path: ' </font><font color="#007700">. </font><font color="#0000BB">$file</font><font color="#007700">-&gt;</font><font color="#0000BB">getPath</font><font color="#007700">() );<br />&nbsp;&nbsp;&nbsp;&nbsp;echo( </font><font color="#DD0000">'&lt;br&gt;LastModified: ' </font><font color="#007700">. </font><font color="#0000BB">$file</font><font color="#007700">-&gt;</font><font color="#0000BB">getLastModified</font><font color="#007700">() );<br />&nbsp;&nbsp;&nbsp;&nbsp;echo( </font><font color="#DD0000">'&lt;br&gt;File size: ' </font><font color="#007700">. </font><font color="#0000BB">$file</font><font color="#007700">-&gt;</font><font color="#0000BB">getSize</font><font color="#007700">() );<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">// Contents<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">YDDebugUtil</font><font color="#007700">::</font><font color="#0000BB">dump</font><font color="#007700">( </font><font color="#0000BB">$file</font><font color="#007700">-&gt;</font><font color="#0000BB">getContents</font><font color="#007700">(), </font><font color="#DD0000">'$file-&gt;getContents()' </font><font color="#007700">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">// Contents<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">YDDebugUtil</font><font color="#007700">::</font><font color="#0000BB">dump</font><font color="#007700">( </font><font color="#0000BB">$file</font><font color="#007700">-&gt;</font><font color="#0000BB">getContents</font><font color="#007700">( </font><font color="#0000BB">2</font><font color="#007700">, </font><font color="#0000BB">3 </font><font color="#007700">), </font><font color="#DD0000">'$file-&gt;getContents( 2, 3 )' </font><font color="#007700">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">// Try to instantiate an object for a non existing file<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$file </font><font color="#007700">= new </font><font color="#0000BB">YDFSFile</font><font color="#007700">( </font><font color="#DD0000">'nofile.php' </font><font color="#007700">);<br /><br /></font><font color="#0000BB">?&gt;</font>
</font>
</code></div><br />
<br />
<h4> Using images </h4>
<br />
For images, we have a different class, the YDFSImage class which extends the YDFSFile class and add some functionality which is only applicable to images. All functionality of the YDFSFile class however is still available. For images, you can determine the following extra properties in addition to the ones covered by the YDFSFile class:<br />
<br />
<ul><li> <strong>getImageSize</strong>: this will return the size of the image in pixels as an array of two elements
</li><li> <strong>getWidth</strong>: this will return the width of the image
</li><li> <strong>getHeight</strong>: this will return the height of the image
</li><li> <strong>getImageType</strong>: returns the image type of the image, which is either "jpg", "gif" or "png".
</li><li> <strong>getMimeType</strong>: this will return the mime type of the image</li></ul>
<br />
The following code sample gives you an example of getting the properties of an image:<br />
<br />
<div class="code"><code><font color="#000000">
<font color="#0000BB">&lt;?php<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;YDInclude</font><font color="#007700">( </font><font color="#DD0000">'YDFileSystem.php' </font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">YDInclude</font><font color="#007700">( </font><font color="#DD0000">'YDUtil.php' </font><font color="#007700">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">// Get the file object for the current file<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$img </font><font color="#007700">= new </font><font color="#0000BB">YDFSImage</font><font color="#007700">( </font><font color="#0000BB">dirname</font><font color="#007700">( </font><font color="#0000BB">__FILE__ </font><font color="#007700">) . </font><font color="#DD0000">'/fsimage.jpg' </font><font color="#007700">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">// Dump the object<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">YDDebugUtil</font><font color="#007700">::</font><font color="#0000BB">dump</font><font color="#007700">( </font><font color="#0000BB">$img</font><font color="#007700">, </font><font color="#0000BB">__FILE__ </font><font color="#007700">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">// Dump the object<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#007700">echo( </font><font color="#DD0000">'&lt;br&gt;Basename: ' </font><font color="#007700">. </font><font color="#0000BB">$img</font><font color="#007700">-&gt;</font><font color="#0000BB">getBasename</font><font color="#007700">() );<br />&nbsp;&nbsp;&nbsp;&nbsp;echo( </font><font color="#DD0000">'&lt;br&gt;Extension: ' </font><font color="#007700">. </font><font color="#0000BB">$img</font><font color="#007700">-&gt;</font><font color="#0000BB">getExtension</font><font color="#007700">() );<br />&nbsp;&nbsp;&nbsp;&nbsp;echo( </font><font color="#DD0000">'&lt;br&gt;Path: ' </font><font color="#007700">. </font><font color="#0000BB">$img</font><font color="#007700">-&gt;</font><font color="#0000BB">getPath</font><font color="#007700">() );<br />&nbsp;&nbsp;&nbsp;&nbsp;echo( </font><font color="#DD0000">'&lt;br&gt;LastModified: ' </font><font color="#007700">. </font><font color="#0000BB">$img</font><font color="#007700">-&gt;</font><font color="#0000BB">getLastModified</font><font color="#007700">() );<br />&nbsp;&nbsp;&nbsp;&nbsp;echo( </font><font color="#DD0000">'&lt;br&gt;File size: ' </font><font color="#007700">. </font><font color="#0000BB">$img</font><font color="#007700">-&gt;</font><font color="#0000BB">getSize</font><font color="#007700">() );<br />&nbsp;&nbsp;&nbsp;&nbsp;echo( </font><font color="#DD0000">'&lt;br&gt;Width: ' </font><font color="#007700">. </font><font color="#0000BB">$img</font><font color="#007700">-&gt;</font><font color="#0000BB">getWidth</font><font color="#007700">() );<br />&nbsp;&nbsp;&nbsp;&nbsp;echo( </font><font color="#DD0000">'&lt;br&gt;Height: ' </font><font color="#007700">. </font><font color="#0000BB">$img</font><font color="#007700">-&gt;</font><font color="#0000BB">getHeight</font><font color="#007700">() );<br />&nbsp;&nbsp;&nbsp;&nbsp;echo( </font><font color="#DD0000">'&lt;br&gt;Image type: ' </font><font color="#007700">. </font><font color="#0000BB">$img</font><font color="#007700">-&gt;</font><font color="#0000BB">getImageType</font><font color="#007700">() );<br />&nbsp;&nbsp;&nbsp;&nbsp;echo( </font><font color="#DD0000">'&lt;br&gt;MIME type: ' </font><font color="#007700">. </font><font color="#0000BB">$img</font><font color="#007700">-&gt;</font><font color="#0000BB">getMimeType</font><font color="#007700">() );<br /><br /></font><font color="#0000BB">?&gt;</font>
</font>
</code></div><br />
One of the most common things people creating web applications do with images is creating thumbnails. Creating thumbnails looks easy, but it can quickly get difficult. To help you with this, the Yellow Duck Framework has some built-in functions that take care of all the difficult work you normally have to perform to create thumbnails. Additionally, the Yellow Duck Framework allows you to create thumbnails from a GIF image, which the standard GD library included with PHP is not capable of.<br />
<br />
To generate thumbnails, there are two functions from the YDFSImage class you can use. They use the algorithm, but only differ in what they do with the output.<br />
<br />
<ul><li> <strong>outputThumbnail</strong>: creates a thumbnail and outputs it directly to the browser
</li><li> <strong>saveThumbnail</strong>: creates a thumbnail and save it to the specified file</li></ul>
<br />
For each of these two functions, you can specify a width and a height. This width and height specify the maximum size of the thumbnail. Also keep in mind that all scaling is done proportionally. Here's a code example that demonstrates this:<br />
<br />
<div class="code"><code><font color="#000000">
<font color="#0000BB">&lt;?php<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;YDInclude</font><font color="#007700">( </font><font color="#DD0000">'YDFileSystem.php' </font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">YDInclude</font><font color="#007700">( </font><font color="#DD0000">'YDUtil.php' </font><font color="#007700">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">// Get the file object for the current file<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$img </font><font color="#007700">= new </font><font color="#0000BB">YDFSImage</font><font color="#007700">( </font><font color="#0000BB">dirname</font><font color="#007700">( </font><font color="#0000BB">__FILE__ </font><font color="#007700">) . </font><font color="#DD0000">'/fsimage.jpg' </font><font color="#007700">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">// Create a thumbnail and save it to fsimage.thumb.jpg<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$img</font><font color="#007700">-&gt;</font><font color="#0000BB">saveThumbnail</font><font color="#007700">( </font><font color="#0000BB">150</font><font color="#007700">, </font><font color="#0000BB">110</font><font color="#007700">, </font><font color="#DD0000">'fsimage.thumb.jpg' </font><font color="#007700">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">//&nbsp;&nbsp;Create a thumbnail and output it directly to the webbrowser<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$img</font><font color="#007700">-&gt;</font><font color="#0000BB">outputThumbnail</font><font color="#007700">( </font><font color="#0000BB">150</font><font color="#007700">, </font><font color="#0000BB">110 </font><font color="#007700">);<br /><br /></font><font color="#0000BB">?&gt;</font>
</font>
</code></div><br />
As creating thumbnails is quite a heavy task for the webserver and PHP (imagine 100 clients requesting the same thumbnail at the same time), the thumbnails are cached by default to increase performance. Caching is only happening of course with the outputThumbnail function and can be disabled by changing the way you call the outputThumbnail function. Here's an example:<br />
<br />
<div class="code"><code><font color="#000000">
<font color="#0000BB">&lt;?php<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;YDInclude</font><font color="#007700">( </font><font color="#DD0000">'YDFileSystem.php' </font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">YDInclude</font><font color="#007700">( </font><font color="#DD0000">'YDUtil.php' </font><font color="#007700">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">// Get the file object for the current file<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$img </font><font color="#007700">= new </font><font color="#0000BB">YDFSImage</font><font color="#007700">( </font><font color="#0000BB">dirname</font><font color="#007700">( </font><font color="#0000BB">__FILE__ </font><font color="#007700">) . </font><font color="#DD0000">'/fsimage.jpg' </font><font color="#007700">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">//&nbsp;&nbsp;Create a thumbnail and output it directly to the webbrowser with caching<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$img</font><font color="#007700">-&gt;</font><font color="#0000BB">outputThumbnail</font><font color="#007700">( </font><font color="#0000BB">150</font><font color="#007700">, </font><font color="#0000BB">110</font><font color="#007700">, </font><font color="#0000BB">true </font><font color="#007700">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">//&nbsp;&nbsp;Create a thumbnail and output it directly to the webbrowser without caching<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$img</font><font color="#007700">-&gt;</font><font color="#0000BB">outputThumbnail</font><font color="#007700">( </font><font color="#0000BB">150</font><font color="#007700">, </font><font color="#0000BB">110</font><font color="#007700">, </font><font color="#0000BB">false </font><font color="#007700">);<br /><br /></font><font color="#0000BB">?&gt;</font>
</font>
</code></div><br />
The image cache files are stored in the temp directory which is put in the YDFramework2 directory.<br />
<br />
<h4> Using directories </h4>
<br />
Directories are also a special kind of object, the YDFSDirectory object. This class is not based on the YDFSFile classes, but will use them internally. The YDFSDirectory class can return a number of properties from the directory it's pointing to:<br />
<br />
<ul><li> <strong>getPath</strong>: returns the complete path to the directory
</li><li> <strong>isWriteable</strong>: boolean indicating if the directory is writeable or not (this is not working properly on Windows)</li></ul>
<br />
In addition, there is a function called <strong>getContents</strong> that is able to return the contents of a directory as YDFS* objects. As it's argument, it takes a file pattern which is the same type of pattern you use in the shell (such as bash, terminal or the command prompt). Depending on the file type of each individual file, it will return a YDFSFile, YDFSImage or YDFSDirectory object. Here's an example illustrating this:<br />
<br />
<div class="code"><code><font color="#000000">
<font color="#0000BB">&lt;?php<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;YDInclude</font><font color="#007700">( </font><font color="#DD0000">'YDFileSystem.php' </font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">YDInclude</font><font color="#007700">( </font><font color="#DD0000">'YDUtil.php' </font><font color="#007700">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">// Get the directory object for the current directory<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$dir </font><font color="#007700">= new </font><font color="#0000BB">YDFSDirectory</font><font color="#007700">( </font><font color="#0000BB">dirname</font><font color="#007700">( </font><font color="#0000BB">__FILE__ </font><font color="#007700">) );<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">// Dump the object<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">YDDebugUtil</font><font color="#007700">::</font><font color="#0000BB">dump</font><font color="#007700">( </font><font color="#0000BB">$dir</font><font color="#007700">, </font><font color="#0000BB">dirname</font><font color="#007700">( </font><font color="#0000BB">__FILE__ </font><font color="#007700">) );<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">// All files in the directory<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">YDDebugUtil</font><font color="#007700">::</font><font color="#0000BB">dump</font><font color="#007700">( </font><font color="#0000BB">$dir</font><font color="#007700">-&gt;</font><font color="#0000BB">getContents</font><font color="#007700">() );<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">// TPL files in the directory<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">YDDebugUtil</font><font color="#007700">::</font><font color="#0000BB">dump</font><font color="#007700">( </font><font color="#0000BB">$dir</font><font color="#007700">-&gt;</font><font color="#0000BB">getContents</font><font color="#007700">( </font><font color="#DD0000">'*.tpl' </font><font color="#007700">) );<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">// JPG and txt files in the directory<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">YDDebugUtil</font><font color="#007700">::</font><font color="#0000BB">dump</font><font color="#007700">( </font><font color="#0000BB">$dir</font><font color="#007700">-&gt;</font><font color="#0000BB">getContents</font><font color="#007700">( array( </font><font color="#DD0000">'*.jpg'</font><font color="#007700">, </font><font color="#DD0000">'*.txt' </font><font color="#007700">) ) )<br /><br /></font><font color="#0000BB">?&gt;</font>
</font>
</code></div><br />
<a href="Documentation.html">Documentation table of contents</a></div>




    <div class="copyright">
        (c) Copyright 2003-2004 by <a href="mailto:pieter@yellowduck.be">Pieter Claerhout</a>. All rights reserved.
    </div>

</body>

</html>