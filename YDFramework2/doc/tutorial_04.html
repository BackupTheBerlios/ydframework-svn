<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">


<html>

<head>

    <meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
    <title>YDF2 - Using templates</title>
    <link href="api/doxygen.css" rel="stylesheet" type="text/css">

</head>

<body>

    <h1>Yellow Duck Framework </h1>

    <h3 align="center">version 2.0.0 </h3>

    <hr size="1" noshade>
    <table width="100%" border="0" cellspacing="0" cellpadding="0">
    <tr>
        <td align="left" width="40%">
            [ <a href="tutorial_03.html">previous</a> ]
            <br>
            <font size="-1"><i>How requests are processed</i></font>
        </td>
        <td align="center" width="20%" valign="top">
            [ <a href="index.html">contents</a> ]
        </td>
        <td align="right" width="40%">
            [ <a href="tutorial_05.html">next</a> ]
            <br>
            <font size="-1"><i>Using and validating forms</i></font>
        </td>
    </tr>
    </table>
    <hr size="1" noshade>

    <h3>5. Using templates</h3>
    
    <hr size="1" noshade>

    <p><b>Introduction</b></p>

    <p>In this chapter, we will have a closer look at how the template engine in
    the Yellow Duck Framework is working and how it's implemented. The template
    engine in the framework is based on PHP and follows the same syntax as any
    normal PHP file.</p>

    
    <p>&nbsp;<br><b>The YDTemplate class</b></p>

    <p>For managing templates, there is a specific class class YDTemplate. If
    you instantiate this class, you can assign variables to it, and then, using
    these variables, you can output a named template.</p>

    <p>The following code sample gives you a small example on how this works:
    </p>

    <p><pre class="fragment">$array = array(
    array(
        'author' => 'Stephen King',
        'title' => 'The Stand'
    ),
    array(
        'author' => 'Neal Stephenson',
        'title' => 'Cryptonomicon'
    ),
    array(
        'author' => 'Milton Friedman',
        'title' => 'Free to Choose'
    )
);

$template = new YDTemplate();
$template->setVar( 'title', 'This is the title' );
$template->setVar( 'array', $array );
echo( $template->getOutput( 'mytemplate' ) );</pre></p>

    <p>The template for this code could look as follows:</p>

    <p><pre class="fragment">&lt;html&gt;

&lt;head&gt;
    &lt;title&gt;&lt;?= $title ?&gt;&lt;/title&gt;
&lt;/head&gt;

&lt;body&gt;
    &lt;?php if ( is_array( $book ) ): ?&gt;
        &lt;table&gt;
            &lt;tr&gt;
                &lt;th&gt;Author&lt;/th&gt;
                &lt;th&gt;Title&lt;/th&gt;
            &lt;/tr&gt;
            &lt;?php foreach ( $book as $key =&gt; $val ): ?&gt;
                &lt;tr&gt;
                    &lt;td&gt;&lt;?= $val['author'] ?&gt;&lt;/td&gt;
                    &lt;td&gt;&lt;?= $val['title'] ?&gt;&lt;/td&gt;
                &lt;/tr&gt;
            &lt;?php endforeach; ?&gt;
        &lt;/table&gt;
    &lt;?php else: ?&gt;
        &lt;p&gt;There are no books to display.&lt;/p&gt;
    &lt;?php endif; ?&gt;
&lt;/body&gt;

&lt;/html&gt;</pre></p>

    <p>As you can see, we assigned two variables to our template instance. Each
    variable you want to use in the template engine needs to be assigned to the
    template instance before you can use it. Assigning a variable to a template
    implies that we attach a template variable name to a PHP object. These
    objects can be anything from an array, a simple string to even a complete
    object.</p>

    <p>Once we assigned all the variables, we can issue the "getOutput" function
    of the template class to get the result of the parsed template. This
    function takes one argument, which is the name of the template.</p>

    <p>The name of the template you need to specify for the "getOutput" function
    is the basename of the template without the "tpl" extension. In our example,
    you would need the following files to make the example work:</p>

    <ul>
        <li><b>mytemplate.php</b>: the actual PHP script</li>
        <li><b>mytemplate.tpl</b>: the template attached to the PHP script</li>
    </ul>

    <p>By convention, all templates have the extension "tpl". This is also
    hardcoded in the framework itself. Please, stick to this standard.</p>


    <p>&nbsp;<br><b>Template search paths</b></p>

    <p>There are different ways on where the template engine will search for
    templates. By default, there are two possible ways of specifying the path
    for the templates:</p>

    <ul>
        <li><b>Template specified by base name</b>: this will cause the template
        engine to look in the same directory as the current script.</li>
        <li><b>Template specified by a full path</b>:  this will cause the
        template engine to look for the template at the specified path.</li>
    </ul>

    <p>If you want, you can override the default search path for the templates.
    This is done by the class function "setTemplateDir" of the template class.
    With this function, you can add an extra path to the search path of the
    template class. After you added a new path, you can specify templates in
    that directory by their basename instead of having to specify the full
    path for the template.</p>


    <p>&nbsp;<br><b>Template tags</b></p>

    <p>In the template, you can use the standard PHP functions and constructs to
    work with the data in the template. Here's a list of sample constructs that
    are used a lot:</p>

    <p><pre class="fragment"><span class="comment">// Outputting a variable</span>
&lt;?= $myVar ?&gt;</pre></p>

    <p><pre class="fragment"><span class="comment">// A foreach loop</span>
&lt;?php foreach ( $array as $key => $value ) ?&gt;
    &lt;?= $key ?&gt; -&gt; &lt;?= $value ?&gt;&lt;br&gt;
&lt;?php } ?&gt;</pre></p>

    <p><pre class="fragment"><span class="comment">// An if structure</span>
&lt;?php if ( $value ) ?&gt;
    Value present: &lt;?= $value ?&gt;
&lt;?php } else { ?&gt;
    Value not present!
&lt;?php } ?&gt;</pre></p>

    <p><pre class="fragment"><span class="comment">// An for loop</span>
&lt;?php if ( $value ) ?&gt;
    Value present: &lt;?= $value ?&gt;
&lt;?php } else { ?&gt;
    Value not present!
&lt;?php } ?&gt;</pre></p>

    <p><pre class="fragment"><span class="comment">// A switch construct</span>
&lt;?php if ( $value ) ?&gt;
    Value present: &lt;?= $value ?&gt;
&lt;?php } else { ?&gt;
    Value not present!
&lt;?php } ?&gt;</pre></p>

    <p><pre class="fragment"><span class="comment">// Associative arrays</span>
&lt;?php if ( $value ) ?&gt;
    Value present: &lt;?= $value ?&gt;
&lt;?php } else { ?&gt;
    Value not present!
&lt;?php } ?&gt;</pre></p>

    <p><pre class="fragment"><span class="comment">// Objects</span>
&lt;?php if ( $value ) ?&gt;
    Value present: &lt;?= $value ?&gt;
&lt;?php } else { ?&gt;
    Value not present!
&lt;?php } ?&gt;</pre></p>


    <p>&nbsp;<br><b>Standard template variables</b></p>

    <p>For each template, there are a number of standard variables available
    which you can always reference. These variables all start with "YD_" and
    are all uppercase. Here's the list of the standard variables:</p>

    <p><table width="100%" border="1" cellspacing="0" cellpadding="2">
    <tr>
        <td width="30%"><b>Variable</b></td>
        <td width="70%"><b>Explanantion</b></td>
    </tr>
    <tr>
        <td valign="top">YD_FW_NAME</td>
        <td>name of the framework</td>
    </tr>
    <tr>
        <td valign="top">YD_FW_VERSION</td>
        <td>version of the framework</td>
    </tr>
    <tr>
        <td valign="top">YD_FW_NAMEVERS</td>
        <td>the combination of the two items above</td>
    </tr>
    <tr>
        <td valign="top">YD_FW_HOMEPAGE</td>
        <td>the homepage of the Yellow Duck Framework</td>
    </tr>
    <tr>
        <td valign="top">YD_SELF_SCRIPT</td>
        <td>the current script's path, e.g. "/myapp/index.php"</td>
    </tr>
    <tr>
        <td valign="top">YD_SELF_URI</td>
        <td>the URI which was given in order to access this page, e.g. 
        "/myapp/index.php?do=edit"</td>
    </tr>
    <tr>
        <td valign="top">YD_ACTION_PARAM</td>
        <td>the name of the $_GET parameter that specifies which action needs to 
        be executed. This is "do" by convention.</td>
    </tr>
    <tr>
        <td valign="top">YD_ENV</td>
        <td>These variables are imported into PHP's global namespace from the 
        environment under which the PHP parser is running.</td>
    </tr>
    <tr>
        <td valign="top">YD_COOKIE</td>
        <td>An associative array of variables passed to the current script via 
        HTTP cookies.</td>
    </tr>
    <tr>
        <td valign="top">YD_GET</td>
        <td>An associative array of variables passed to the current script via 
        the HTTP GET method.</td>
    </tr>
    <tr>
        <td valign="top">YD_POST</td>
        <td>An associative array of variables passed to the current script via 
        the HTTP POST method.</td>
    </tr>
    <tr>
        <td valign="top">YD_FILES</td>
        <td>An associative array of items uploaded to the current script via the
        HTTP POST method.</td>
    </tr>
    <tr>
        <td valign="top">YD_REQUEST</td>
        <td>An associative array consisting of the contents of YD_GET, YD_POST 
        and YD_COOKIE.</td>
    </tr>
    <tr>
        <td valign="top">YD_SESSION</td>
        <td>An associative array containing session variables available to the 
        current script.</td>
    </tr>
    <tr>
        <td valign="top">YD_GLOBALS</td>
        <td>An associative array containing references to all variables which 
        are currently defined in the global scope of the script.</td>
    </tr>
    <tr>
        <td valign="top">YD_DB_CONN_CNT</td>
        <td>Number of database connections that were made.</td>
    </tr>
    <tr>
        <td valign="top">YD_DB_SQLQ_CNT</td>
        <td>Number of database queries that were performed.</td>
    </tr>
    </table></p>

    <p><b>Note:</b> Please do not use the "YD_" prefix for your own variables.
    This prefix is uniquely reserverd for the variables automatically assigned
    by the Yellow Duck Framework.</p>

    <p>&nbsp;<br><b>Interesting things to know</b></p>

    <p><i>PHP configuration for short open tags</i></p>

    <p>Depending on how you want to write the PHP constructs, you might need to
    enable the short open tags function in PHP. This is done by changing the PHP
    configuration in php.ini or using a .htaccess file. You will need to add the
    following line to enable short open tags:</p>

    <p><b>Using a .htaccess file</b><br>
    <pre class="fragment">php_flag short_open_tag On</pre></p>

    <p><b>Using php.ini</b><br>
    <pre class="fragment">short_open_tag = On</pre></p>

    <p>If you enable the short open tags, you will be able to shorten the
    following constructs in the templates:</p>

    <p><b>Not using short open tags</b><br><pre class="fragment">&lt;?php echo( $myVar ) ?&gt;</pre></p>
    
    <p><b>Using short open tags</b><br><pre class="fragment">&lt;?= $myVar ?&gt;</pre></p>

    <p>All the examples for the Yellow Duck Framework have been written using
    short open tags. Make sure you have them enabled before running the
    examples.</p>

    <p><i>What to put in the template and what to put in the script</i></p>

    <p>Try to put as less as possible in the templates. Templates should contain
    nothing more than output of variables, if structures and for(each)
    constructs. The template should never change the actual data, but should
    just describe how the data should be presented.</p>

    
    <hr size="1" noshade>
    <table width="100%" border="0" cellspacing="0" cellpadding="0">
    <tr>
        <td align="left" width="40%">
            [ <a href="tutorial_03.html">previous</a> ]
            <br>
            <font size="-1"><i>How requests are processed</i></font>
        </td>
        <td align="center" width="20%" valign="top">
            [ <a href="index.html">contents</a> ]
        </td>
        <td align="right" width="40%">
            [ <a href="tutorial_05.html">next</a> ]
            <br>
            <font size="-1"><i>Using and validating forms</i></font>
        </td>
    </tr>
    </table>
    <hr size="1" noshade>

    <address><small>
        Yellow Duck Framework 2.0.0 by Pieter Claerhout,
        <a href="mailto:pieter@yellowduck.be">pieter@yellowduck.be</a>
    </small></address>

</body>

</html>
